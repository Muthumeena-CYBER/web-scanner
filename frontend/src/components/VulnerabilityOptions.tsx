import React, { useState } from 'react';
import { VulnerabilityCheckbox } from './VulnerabilityCheckbox';
import { ChevronDown, ChevronUp } from 'lucide-react';

interface VulnerabilityOptionsProps {
  sqli: boolean;
  xss: boolean;
  csrf: boolean;
  onSqliChange: (checked: boolean) => void;
  onXssChange: (checked: boolean) => void;
  onCsrfChange: (checked: boolean) => void;
}

export const VulnerabilityOptions: React.FC<VulnerabilityOptionsProps> = ({
  sqli,
  xss,
  csrf,
  onSqliChange,
  onXssChange,
  onCsrfChange,
}) => {
  const [expanded, setExpanded] = useState(true);

  return (
    <div className="w-full max-w-3xl mx-auto">
      <button
        onClick={() => setExpanded(!expanded)}
        className="w-full flex items-center justify-between p-4 bg-gray-50 border-2 border-gray-200 rounded-lg hover:bg-gray-100 transition-colors"
      >
        <span className="font-semibold text-gray-900">Vulnerability Checks</span>
        {expanded ? <ChevronUp className="h-5 w-5" /> : <ChevronDown className="h-5 w-5" />}
      </button>

      {expanded && (
        <div className="mt-4 space-y-3">
          <VulnerabilityCheckbox
            vulnType="sqli"
            label="SQL Injection (SQLi)"
            checked={sqli}
            onChange={onSqliChange}
            description="Detect SQL injection vulnerabilities through error-based, boolean-based, and time-based payloads"
          />
          <VulnerabilityCheckbox
            vulnType="xss"
            label="Cross-Site Scripting (XSS)"
            checked={xss}
            onChange={onXssChange}
            description="Identify reflected XSS vulnerabilities in GET query parameters"
          />
          <VulnerabilityCheckbox
            vulnType="csrf"
            label="Cross-Site Request Forgery (CSRF)"
            checked={csrf}
            onChange={onCsrfChange}
            description="Detect missing CSRF tokens, weak tokens, and improper cookie handling"
          />
        </div>
      )}
    </div>
  );
};
